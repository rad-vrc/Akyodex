# Cloudflare Pages Configuration
# https://developers.cloudflare.com/pages/functions/wrangler-configuration/

name = "akyodex"
compatibility_date = "2025-01-22"
compatibility_flags = ["nodejs_compat"]

# Pages-specific settings
# OpenNext Cloudflare generates output in .open-next directory
pages_build_output_dir = ".open-next"

[vars]
NEXT_PUBLIC_APP_URL = "https://akyodex.com"
NEXT_PUBLIC_R2_BASE = "https://images.akyodex.com"
GITHUB_REPO_OWNER = "rad-vrc"
GITHUB_REPO_NAME = "Akyodex"
GITHUB_BRANCH = "main"
GITHUB_CSV_PATH_JA = "data/akyo-data-ja.csv"

# Bindings for Cloudflare Pages Functions runtime
# Replace the placeholder IDs/names below with the actual ones from your account
[[kv_namespaces]]
binding = "AKYO_KV"

id = "42b435eff5ca4de9a33d70faff6c6abc"

[[kv_namespaces]]
binding = "NEXT_TAG_CACHE_KV"
# NOTE: Shared with AKYO_KV for now.
# Key spaces are non-overlapping:
# - app data cache uses "akyo-data-*"
# - OpenNext tag cache uses "<NEXT_BUILD_ID>/<tag>"
# 運用上分離したい場合は dedicated KV namespace ID に差し替えてください。
id = "42b435eff5ca4de9a33d70faff6c6abc"


[[r2_buckets]]
binding = "AKYO_BUCKET"
bucket_name = "akyo-images"

[[r2_buckets]]
binding = "NEXT_INC_CACHE_R2_BUCKET"
bucket_name = "akyodex-cache"


# Environment variables for production

[env.production]
[[env.production.kv_namespaces]]
binding = "AKYO_KV"
id = "42b435eff5ca4de9a33d70faff6c6abc"

[[env.production.kv_namespaces]]
binding = "NEXT_TAG_CACHE_KV"
# NOTE: Productionでも同様に shared namespace を利用中。
id = "42b435eff5ca4de9a33d70faff6c6abc"

[[env.production.r2_buckets]]
binding = "AKYO_BUCKET"
bucket_name = "akyo-images"

[[env.production.r2_buckets]]
binding = "NEXT_INC_CACHE_R2_BUCKET"
bucket_name = "akyodex-cache"


[env.production.vars]
NEXT_PUBLIC_APP_URL = "https://akyodex.com"
NEXT_PUBLIC_R2_BASE = "https://images.akyodex.com"
GITHUB_REPO_OWNER = "rad-vrc"
GITHUB_REPO_NAME = "Akyodex"
GITHUB_BRANCH = "main"
GITHUB_CSV_PATH_JA = "data/akyo-data-ja.csv"

# Secrets (set via wrangler secret or dashboard):
# - GITHUB_TOKEN
# - ADMIN_PASSWORD_OWNER
# - ADMIN_PASSWORD_ADMIN
# - SESSION_SECRET
