# Akyodex - コーディングスタイルと規約

## 言語・ファイル拡張子
- **JavaScript**: `.js` (メインのクライアントサイドコード)
- **TypeScript**: `.ts` (Cloudflare Pages Functionsのみ)
- **HTML**: `.html` (静的ページ)
- **CSS**: `.css` (スタイルシート)

## 命名規則
- **変数・関数**: camelCase (例: `loadAkyoData`, `currentView`)
- **定数**: UPPER_CASE (例: `INITIAL_RENDER_COUNT`)
- **クラス・コンポーネント**: PascalCase (使用頻度低め)
- **ファイル名**: kebab-case (例: `main.js`, `admin.js`)

## コード構造
- **モジュールパターン**: 即時関数 (IIFE) でグローバル汚染防止
- **依存関係**: 外部スクリプトは `defer` 属性で読み込み
- **型チェック**: TypeScriptはPages Functionsのみ、クライアントサイドは無効化

## コメント・ドキュメント
- **ファイルヘッダー**: JSDoc形式で概要説明
- **関数コメント**: パラメータと戻り値の説明
- **インラインコメント**: 複雑なロジックの説明

## エラーハンドリング
- **try-catch必須**: 非同期処理は必ずエラーハンドリング
- **ユーザー通知**: エラー時はトースト通知でユーザーに告知
- **ログ出力**: デバッグ情報は `console.debug` で出力

## セキュリティ・パフォーマンス
- **入力検証**: すべてのユーザー入力は検証・サニタイズ
- **レート制限**: APIエンドポイントにレート制限を実装
- **画像最適化**: WebP形式推奨、遅延読み込み実装済み
- **キャッシュ戦略**: マニフェスト・画像の適切なキャッシュ設定

## 禁止事項
- `any`型の使用 (型安全性確保のため)
- UI/UXデザインの無断変更 (事前承認必須)
- 技術スタックバージョンの無断変更
- 機能デグレード (エラー回避目的)

## テスト・デバッグ
- **デバッグツール**: `test-debug.html`, `test-indexeddb.html`
- **URLパラメータ**: `?reloadBg=1`, `?bgdensity=NN` でデバッグ
- **ログ出力**: 開発時は詳細ログ、本番時は最小限

## バージョン管理
- **コミットメッセージ**: 日本語で機能単位の説明
- **ブランチ戦略**: featureブランチで開発、mainでマージ
- **変更の影響範囲**: 関連ファイルの一括変更を徹底